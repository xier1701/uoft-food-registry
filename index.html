<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>约饭报名 Beta v0.0.1 测试版</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    h1 { color: #e91e63; }
    iframe { border: none; margin-top: 10px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #f5f5f5; }
  </style>
</head>
<body>
  <h1>🍜 约饭报名 Beta v0.0.1 测试版</h1>

  <!-- 1. 报名表单（嵌入你的 Google Form） -->
  <h2>填写报名表</h2>
  <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSd7ZIaZY3jlKepyQcsks99s9GZoZwtC813_PMQiHvoyVb9AFQ/viewform?embedded=true"
          width="100%" height="600"></iframe>

  <!-- 2. 报名结果表格 -->
  <h2>当前报名情况</h2>
  <table id="signup-table">
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>去哪吃？</th>
        <th>吃什么？</th>
        <th>是什么时候？</th>
        <th>想要找多少个人呢？</th>
        <th>有什么忌口/其他要求吗？</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    async function loadData() {
      // ⚠️ 换成你表单关联的 Google Sheet 的 CSV 发布链接
      const url = "https://docs.google.com/spreadsheets/d/1hHyebhKYPIfgjD9qPOS5h0iJp3ey8hQA6hVc6dBhzyI/edit?usp=sharing";
      let res = await fetch(url);
      let text = await res.text();

      let rows = text.trim().split("\n").map(r => r.split(","));
      let data = rows.slice(1); // 去掉表头

      let tbody = document.querySelector("#signup-table tbody");
      tbody.innerHTML = "";
      data.forEach(row => {
        let tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row[0]}</td>   <!-- 时间戳 -->
          <td>${row[1]}</td>   <!-- 去哪吃 -->
          <td>${row[2]}</td>   <!-- 吃什么 -->
          <td>${row[3]}</td>   <!-- 什么时候 -->
          <td>${row[4]}</td>   <!-- 人数上限 -->
          <td>${row[5] || ""}</td> <!-- 忌口/其他 -->
        `;
        tbody.appendChild(tr);
      });
    }

    loadData();
    setInterval(loadData, 30000); // 每 30 秒刷新一次
  </script>
</body>
</html>
